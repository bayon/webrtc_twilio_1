(this["webpackJsonpvideo-call-react"]=this["webpackJsonpvideo-call-react"]||[]).push([[0],{211:function(t,e,n){},212:function(t,e,n){"use strict";n.r(e);var o=n(7),c=n.n(o),i=n(84),a=n.n(i),r=n(17),s=(n(91),n(28)),u=n.n(s),d=n(85),l=n(86),j=n.n(l),p=n(2);var h=function(t){var e=t.setToken,n=t.setName,o=t.setRoom,c=t.name,i=t.room;function a(){return(a=Object(d.a)(u.a.mark((function t(n){var o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.next=3,j.a.post("https://video-call-6915-dev.twil.io/video-token",{identity:c,room:i});case 3:o=t.sent,e(o.data),console.log("got the token with the value ",o.data);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(p.jsxs)("form",{onSubmit:function(t){return a.apply(this,arguments)},children:[Object(p.jsxs)("label",{htmlFor:"name",children:["Name",Object(p.jsx)("input",{type:"text",id:"name",value:c,onChange:function(t){return n(t.target.value)}})]}),Object(p.jsxs)("label",{htmlFor:"room",children:["Room",Object(p.jsx)("input",{type:"text",id:"room",value:i,onChange:function(t){return o(t.target.value)}})]}),Object(p.jsx)("button",{typ:"submit",children:"Join"})]})},b=n(29),m=n.n(b);var f=function(t){var e=t.token,n=t.room,c=Object(o.useRef)(),i=Object(o.useRef)();function a(t,e){var n=document.createElement("div");n.setAttribute("id",e),n.appendChild(t.attach()),i.current.appendChild(n)}return Object(o.useEffect)((function(){return console.log("Trying to connect to Twilio with token",e),m.a.connect(e,{video:!0,audio:!0,name:n}).then((function(t){function e(t){console.log("Adding a new Participant"),t.tracks.forEach((function(e){e.isSubscribed&&(a(e.track,t.identity),console.log("Attached a track"))})),t.on("trackSubscribed",(function(e){a(e,t.identity)}))}console.log("connected to Twilio"),m.a.createLocalVideoTrack().then((function(t){c.current.appendChild(t.attach())})),t.participants.forEach(e),t.on("participantConnected",e),t.on("participantDisconnected",(function(t){console.log("Removing participant with identity",t.identity);var e=document.getElementById(t.identity);e.parentNode.removeChild(e)}))})).catch((function(t){console.log("An error happened",t)})),function(){}}),[e,n]),Object(p.jsxs)("div",{children:[Object(p.jsxs)("h1",{children:["Your are in room: ",n]}),Object(p.jsx)("div",{ref:c}),Object(p.jsx)("div",{ref:i})]})};var v=function(){var t=Object(o.useState)(),e=Object(r.a)(t,2),n=e[0],c=e[1],i=Object(o.useState)(""),a=Object(r.a)(i,2),s=a[0],u=a[1],d=Object(o.useState)("room"),l=Object(r.a)(d,2),j=l[0],b=l[1];return Object(p.jsx)("div",{className:"App",children:n?Object(p.jsx)(f,{token:n,room:j}):Object(p.jsx)(h,{setToken:c,setName:u,name:s,setRoom:b,room:j})})};n(211);a.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(v,{})}),document.getElementById("root"))},91:function(t,e,n){}},[[212,1,2]]]);
//# sourceMappingURL=main.15f52631.chunk.js.map